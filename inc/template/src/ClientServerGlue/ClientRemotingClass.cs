// Auto generated by nant generateGlue
// From a template at inc\template\src\ClientServerGlue\RemotableObjects.cs
//
// Do not modify this file manually!
//
{#GPLFILEHEADER}

using System;
using Ict.Common.Remoting.Client;

namespace Ict.Petra.Server.M{#TOPLEVELMODULE}.Instantiator
{
    {#CLASSES}
}

{##CLASS}
/// object that will be serialized to the client.
/// it opens a new channel for each new object. 
/// this is needed for cross domain marshalling.
[Serializable]
public class {#CLASSNAME}: {#INTERFACE}, IKeepAlive
{
    private {#INTERFACE} RemoteObject = null;
    private string FObjectURI;
    /// constructor
    public {#CLASSNAME}(string AObjectURI)
    { 
        FObjectURI = AObjectURI;
    }
    private void InitRemoteObject()
    { 
        RemoteObject = ({#INTERFACE})
            TConnector.TheConnector.GetRemoteObject(FObjectURI,
            typeof({#INTERFACE}));
    }
    /// keep the object alive on the server
    public void KeepAlive()
    {
        if (RemoteObject == null)
        {
            InitRemoteObject();
        }

        // The following call is the key to the whole concept of keeping
        // the remoted server-side Objects alive:
        // Calling 'GetLifeTimeService' is sufficient to 'tickle' the
        // server-side Object and for its Lease to be renewed!
        try
        {
            ((MarshalByRefObject)RemoteObject).InitializeLifetimeService();
        }
        catch (Exception e)
        {
            TLogging.Log(e.ToString());
        }
    }
    {#METHODSANDPROPERTIES}
}

{##PROPERTY}
/// forward the property
public {#TYPE} {#NAME}
{
{#IFDEF GETTER}
    get
    {
        if (RemoteObject == null) { InitRemoteObject(); }
        return RemoteObject.{#NAME};
    }
{#ENDIF GETTER}
{#IFDEF SETTER}
    get
    {
        if (RemoteObject == null) { InitRemoteObject(); }
        RemoteObject.{#NAME} = value;
    }
{#ENDIF SETTER}
}

{##METHOD}
/// forward the method call
public {#RETURNTYPE} {#METHODNAME}({#PARAMETERDEFINITION})
{
    if (RemoteObject == null) { InitRemoteObject(); }
    {#RETURN}RemoteObject.{#METHODNAME}({#ACTUALPARAMETERS});
}