RootNode:
    BaseYaml: ../../../CommonForms/PetraEditForm.yaml
    FormTitle: AP Document Edit
    Namespace: Ict.Petra.Client.MFinance.Gui.AP
    MasterTable: AApDocument
    DetailTable: AApDocumentDetail
    DatasetType: Ict.Petra.Shared.MFinance.AP.Data.AccountsPayableTDS
    UsingNamespaces: [Ict.Petra.Shared.MFinance.AP.Data]
    FormType: edit
    Template: windowEditWebConnectorMasterDetail
    WindowWidth: 750
    WindowHeight: 600
    Actions:
        cndDiscountEnabled: {InitialValue=false}
        actNewDetail: {Label=Add De&tail, ActionClick=NewDetail}
        actRemoveDetail:  {Label=&Remove Detail, ActionClick=RemoveDetail}
        actPostDocument: {Label=Post Document, ActionClick=PostDocument}
    Controls:
        pnlContent:
            Controls: [pnlSupplierInfo, grpDocumentInfo, grpDetails]
            Dock: Fill
        pnlSupplierInfo:
            Controls: [txtSupplierName, txtSupplierCurrency]
            ControlsOrientation: horizontal
            Dock:Top
        txtSupplierName: {Label=Current Supplier, ReadOnly=true, PartnerShortNameLookup=AApDocument.PartnerKey}
        txtSupplierCurrency: {Label=Currency, ReadOnly=true, DataField=AApSupplier.CurrencyCode}
        grpDocumentInfo:
            Label: Document Information
            Controls: 
                Row0: [txtDocumentCode, cmbDocumentType]
                Row1: [txtReference]
                Row2: [dtpDateIssued, dtpDateDue, nudCreditTerms]
                Row3: [nudDiscountDays, txtDiscountPercentage]
                Row4: [txtTotalAmount, txtExchangeRateToBase]
            Dock: Top
        txtDocumentCode: {Label=Invoice &Number}
        cmbDocumentType:
            OptionalValues: [=Invoice, Credit Note]
            Label: T&ype
            DataField: CreditNoteFlag
        txtReference: {Label=&Reference, ColSpan=2}
        dtpDateIssued: {Label=&Date Issued, OnChange=UpdateCreditTerms}
        nudCreditTerms:
            Label: Credit &Terms
            Width: 50
            OnChange: UpdateCreditTermsOverload
        dtpDateDue:
            Label: Date D&ue
            Tooltip: Credit Terms is the number of days between date issued and due date
            OnChange: UpdateCreditTerms
        nudDiscountDays: {Label=Discount &Days, PositiveValueActivates=cndDiscountEnabled}
        txtDiscountPercentage: {Label=Discount &Value (%), Enabled=cndDiscountEnabled}
        txtTotalAmount:
            Label: &Amount
        txtExchangeRateToBase:
            Label: E&xchange Rate
            # TODO: default value from daily exchange rate? update daily exchange rate?
        grpDetails:
            Label: Details
            Dock: Fill
            Controls: [pnlDetailGrid, pnlDetails]
        pnlDetailGrid:
            Dock: Fill
            Controls: [grdDetails, pnlDetailButtons]
        pnlDetailButtons:
            Dock: Right
            Controls: [btnAddDetail, btnRemoveDetail, btnAnalysisAttributes]
        grdDetails:
            Dock: Fill
            Columns: [AApDocumentDetail.Amount, AApDocumentDetail.Narrative, AApDocumentDetail.ItemRef]
            ActionFocusRow: FocusedRowChanged
        pnlDetails:
            Dock: Bottom
            Controls:
                Row0: [txtDetailNarrative]
                Row1: [txtDetailItemRef]
                Row2: [txtDetailAmount, cmbDetailCostCentreCode, btnUseTaxAccountCostCentre]
                Row3: [txtDetailBaseAmount, cmbDetailAccountCode]
        txtDetailNarrative:
            ColSpan: 2
            Width: 350
            Label: Narrati&ve
        txtDetailItemRef:
            ColSpan: 2
            Width: 350
            Label: Detail &Ref
        txtDetailAmount:
            Label: A&mount
        txtDetailBaseAmount:
            Label: Base
            ReadOnly: true
            #TODO: calculate using exchange rate from document
# TODO: Approval completely disabled for the moment
#        dtpDetailApprovalDate:
#            Label: Approved On
#            ReadOnly: true
        cmbDetailCostCentreCode: {Label=C&ost Centre, List=UserDefinedList}
        cmbDetailAccountCode: {Label=Accou&nt, List=UserDefinedList}
        btnUseTaxAccountCostCentre:
            Label: Use Ta&x Acct+CC
            #TODO
        btnAddDetail:
            Width: 100
            Action: actNewDetail
        btnRemoveDetail: {Enabled=false}
            Label: &Remove Detail
            Width: 100
            Action: actRemoveDetail
        btnAnalysisAttributes:
            Label: Analysis Attri&b.
            Width: 100
# TODO: Approval completely disabled for the moment
#        btnApproveDetail:
#            Label: A&pprove Detail
#            Align: Right
#            Width: 150
#            Enabled: false
    Toolbar:
        tbbPostDocument: