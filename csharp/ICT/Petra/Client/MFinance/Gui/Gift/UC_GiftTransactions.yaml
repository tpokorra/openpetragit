RootNode:
    BaseClass: System.Windows.Forms.UserControl
    UtilObjectClass: TFrmPetraEditUtils
    Namespace: Ict.Petra.Client.MFinance.Gui.Gift
    DatasetType: Ict.Petra.Shared.MFinance.Gift.Data.GiftBatchTDS
    DetailTable: AGiftDetail
    UsingNamespaces: [Ict.Petra.Shared.MFinance.Gift.Data]
    FormType: edit
    Template: controlMaintainTable
    Actions:
        actNewGift: {Label=&Add Gift, ActionClick=NewGift}
        actNewDetail: {Label=Add Detai&l, ActionClick=NewGiftDetail}
        actDeleteDetail: {Label=&Delete Detail, ActionClick=DeleteDetail}
    Controls:
        pnlContent:
            Controls: [pnlInfo, pnlDetailGrid, pnlDetails]
            Dock: Fill
        pnlInfo:
            Controls:
                Row0: [txtLedgerNumber, txtBatchNumber]
            Dock: Top
        txtLedgerNumber: {ReadOnly=true, Label=Ledger, Unbound=true}
        txtBatchNumber: {ReadOnly=true, Label=Gift Batch, Unbound=true}
        pnlDetailGrid:
            Dock: Fill
            Controls: [grdDetails, pnlDetailButtons]
        pnlDetailButtons:
            Dock: Right
            Controls: [btnNewGift, btnNewDetail, btnDeleteDetail]
        btnNewGift: {Action=actNewGift}
        btnNewDetail: {Action=actNewDetail}
        btnDeleteDetail:
        grdDetails:
            TableName: AGiftDetail
            Dock: Fill
            #TODO: support split gifts, and deal with gift details properly
            Columns: [GiftTransactionNumber, DetailNumber, DateEntered, DonorKey, DonorName, GiftTransactionAmount, RecipientDescription, MotivationGroupCode, MotivationDetailCode]
            CustomColumns:
                DateEntered: {Label=Date Entered, Type=DateTime}
                DonorKey: {Label=Donor Key, Type=PartnerKey}
                DonorName: {Label=Donor Name, Type=String}
                RecipientDescription: {Label=Recipient, Type=String}
            ActionFocusRow: FocusedRowChanged
            SortOrder: GiftTransactionNumber ASC
            RowFilter: AGiftDetail.BatchNumber
        pnlDetails:
            Dock: Bottom
            # TODO: many more details: confidential, comment, key ministry, etc
            # TODO: split gifts
            Controls: 
                Row0: [txtDetailDonorKey]
                Row0a: [dtpDateEntered]
                Row1: [txtDetailGiftTransactionAmount, txtCurrencyCode]
                Row2: [txtDetailRecipientKey]
                Row3: [cmbDetailMotivationGroupCode]
                Row4: [cmbDetailMotivationDetailCode]
                Row5: [txtDetailCostCentreCode, txtDetailAccountCode]
        #txtDonorName: {ReadOnly=true, PartnerShortNameLookup=AGiftDetail.DonorKey}
        dtpDateEntered: {Help: This date is used for receipt printing, Unbound=true}
        txtDetailDonorKey: {Label=Donor, Type=PartnerKey, ColSpan=3, Unbound=true}
        txtDetailRecipientKey: {Label=Recipient, Type=PartnerKey, ColSpan=3, OnChange=RecipientKeyChanged}
        cmbDetailMotivationGroupCode: {Label=Motivation Group, List=UserDefinedList, OnChange=FilterMotivationDetail}
        cmbDetailMotivationDetailCode: {Label=Motivation Detail, List=UserDefinedList, OnChange=MotivationDetailChanged}
        txtDetailCostCentreCode: {Label=Cost Centre, List=UserDefinedList, ReadOnly=true}
        txtDetailAccountCode: {Label=Account, List=UserDefinedList, ReadOnly=true}
        txtDetailGiftTransactionAmount: {Label=Amount}
        txtCurrencyCode: {NoLabel=true, ReadOnly=true, Unbound=true}
