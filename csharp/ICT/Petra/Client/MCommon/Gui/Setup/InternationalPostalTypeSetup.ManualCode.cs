//
// DO NOT REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
//
// @Authors:
//       timop
//
// Copyright 2004-2010 by OM International
//
// This file is part of OpenPetra.org.
//
// OpenPetra.org is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// OpenPetra.org is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with OpenPetra.org.  If not, see <http://www.gnu.org/licenses/>.
//
using System;
using System.Data;
using System.Windows.Forms;
using System.Collections.Generic;
using System.Xml;
using GNU.Gettext;
using Ict.Common.Verification;
using Ict.Common;
using Ict.Common.IO;
using Ict.Common.Remoting.Client;
using Ict.Petra.Client.App.Core.RemoteObjects;
using Ict.Petra.Shared.MCommon;
using Ict.Petra.Shared.MCommon.Data;
using Ict.Petra.Shared.MCommon.Validation;

namespace Ict.Petra.Client.MCommon.Gui.Setup
{
    public partial class TFrmInternationalPostalTypeSetup
    {
        private void NewRowManual(ref PInternationalPostalTypeRow ARow)
        {
            string newName = Catalog.GetString("NEWCODE");
            Int32 countNewDetail = 0;

            if (FMainDS.PInternationalPostalType.Rows.Find(new object[] { newName }) != null)
            {
                while (FMainDS.PInternationalPostalType.Rows.Find(new object[] { newName + countNewDetail.ToString() }) != null)
                {
                    countNewDetail++;
                }

                newName += countNewDetail.ToString();
            }

            ARow.InternatPostalTypeCode = newName;
        }

        private void NewRecord(Object sender, EventArgs e)
        {
            CreateNewPInternationalPostalType();
        }
        
        private void DeleteRecord(Object sender, EventArgs e)
        {
        	DeletePInternationalPostalType();
        }
        
        
        /// <summary>
        /// Performs checks to determine whether a deletion of the current
        ///  row is permissable
        /// </summary>
        /// <param name="ARowToDelete">the currently selected row to be deleted</param>
        /// <param name="ADeletionQuestion">can be changed to a context-sensitive deletion confirmation question</param>
        /// <returns>true if user is permitted and able to delete the current row</returns>
        private bool PreDeleteManual(ref PInternationalPostalTypeRow ARowToDelete, ref string ADeletionQuestion)
        {
        	/*Code to execute before the delete can take place*/
        	ADeletionQuestion = String.Format(Catalog.GetString("Are you sure you want to delete Postal Type Code: '{0}'?"),
        	                                  ARowToDelete.InternatPostalTypeCode);
        	return true;
        }

        /// <summary>
        /// Deletes the current row and optionally populates a completion message
        /// </summary>
        /// <param name="ARowToDelete">the currently selected row to delete</param>
        /// <param name="ACompletionMessage">if specified, is the deletion completion message</param>
        /// <returns>true if row deletion is successful</returns>
        private bool DeleteRowManual(ref PInternationalPostalTypeRow ARowToDelete, out string ACompletionMessage)
        {
        	bool deletionSuccessful = false;

        	try
        	{
	        	//Must set the message parameters before the delete is performed if requiring any of the row values
        		ACompletionMessage = String.Format(Catalog.GetString("Postal Type Code: '{0}' deleted successfully."),
        	                                       ARowToDelete.InternatPostalTypeCode);
	        	ARowToDelete.Delete();
	        	deletionSuccessful = true;
        	}
        	catch (Exception ex)
        	{
        		ACompletionMessage = ex.Message;
        		MessageBox.Show(ex.Message,
        		                "Deletion Error",
        		                MessageBoxButtons.OK,
        		                MessageBoxIcon.Error);
        	}
        	
        	return deletionSuccessful;
        }

        /// <summary>
        /// Code to be run after the deletion process
        /// </summary>
        /// <param name="ARowToDelete">the row that was/was to be deleted</param>
        /// <param name="AAllowDeletion">whether or not the user was permitted to delete</param>
        /// <param name="ADeletionPerformed">whether or not the deletion was performed successfully</param>
        /// <param name="ACompletionMessage">if specified, is the deletion completion message</param>
        private void PostDeleteManual(ref PInternationalPostalTypeRow ARowToDelete, bool AAllowDeletion, bool ADeletionPerformed, string ACompletionMessage)
        {
        	/*Code to execute after the delete has occurred*/
        	if (ADeletionPerformed && ACompletionMessage.Length > 0)
        	{
        		MessageBox.Show(ACompletionMessage,
        		                "Deletion Completed",
        		                MessageBoxButtons.OK,
        		                MessageBoxIcon.Information);
        	}
        	else if (!AAllowDeletion)
        	{
        		//message to user	
        	}
        	else if (!ADeletionPerformed)
        	{
        		//message to user
        	}
        }

    }
}