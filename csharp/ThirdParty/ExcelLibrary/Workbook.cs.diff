        /// <summary>
        /// Save workbook to stream.
        /// </summary>
        /// <param name="stream"></param>
        public void Save(Stream stream)
        {
             // see http://code.google.com/p/excellibrary/issues/detail?id=79
             CompoundDocument doc = CompoundDocument.Create(stream);
             MemoryStream memStream = new MemoryStream();
             WorkbookEncoder.Encode(this, memStream);
             doc.WriteStreamData(new string[] { "Workbook" }, memStream.ToArray());
             doc.Save(); 
        

            /* 
            using (CompoundDocument doc = CompoundDocument.Create(stream))
            {
                using (MemoryStream memStream = new MemoryStream())
                {
                    WorkbookEncoder.Encode(this, memStream);
                    doc.WriteStreamData(new string[] { "Workbook" }, memStream.ToArray());
                    doc.Save();
                }
            }
            */

        }
